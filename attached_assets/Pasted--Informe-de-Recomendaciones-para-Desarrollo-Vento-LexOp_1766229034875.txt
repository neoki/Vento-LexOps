 Informe de Recomendaciones para Desarrollo (Vento LexOps)
1. Implementaci칩n del Agente (Python) - Prioridad Cr칤tica 游뚿
El archivo 
agent.py
 est치 actualmente vac칤o. Sin este componente, el sistema no puede funcionar autom치ticamente.

Especificaciones para el LLM Desarrollador:

Lenguaje y Librer칤as: Python 3.9+. Recomiendo usar requests para la API del Backend y selenium o playwright para la interacci칩n con LexNet (ya que requiere navegaci칩n compleja con certificados). Para el manejo de certificados en Windows, pywin32 o acceder al almac칠n de certificados del sistema (wincertstore) es esencial.
L칩gica del Bucle Principal ("Demonio"):
Arranque: Cargar configuraci칩n (AGENT_ID, BACKEND_URL, CERT_THUMBPRINT).
Heartbeat: Ejecutar un POST /api/agent/heartbeat cada 30 segundos enviando m칠tricas simples (uso de CPU/RAM) para que el Dashboard lo muestre "ONLINE".
Polling de Notificaciones:
Conectarse al portal web de LexNet cada X minutos.
Detectar notificaciones nuevas (no le칤das).
Descargar el PDF principal y los adjuntos.
Sincronizaci칩n: Enviar los datos a POST /api/agent/notification (multipart/form-data).
Manejo de Errores: Implementar Exponential Backoff. Si LexNet falla (algo com칰n), esperar 1 min, luego 2, luego 4... no bloquear el script.
2. Mejoras de Seguridad en Backend (
server.ts
)
Actualmente, los endpoints /api/agent/* conf칤an en cualquier petici칩n que incluya un agentId.

Problema: Cualquiera que sepa la URL de tu API puede inyectar datos falsos simulando ser un agente.
Recomendaci칩n: Implementar Autenticaci칩n "Bearer Token" para Agentes.
Generar una API Key 칰nica para cada agente (guardarla en una nueva columna api_key en la tabla agents).
El 
agent.py
 debe enviar el header: Authorization: Bearer <AGENT_API_KEY>.
Crear un middleware requireAgentAuth en 
server.ts
 para proteger las rutas /api/agent/*.
3. Optimizaci칩n del Motor de IA (
server/ai-service.ts
)
Gesti칩n del Prompt: El prompt de an치lisis est치 escrito directamente en el c칩digo ("hardcoded"). Sugiero moverlo a la base de datos o a una variable de entorno. Esto te permitir치 ajustar las instrucciones de la IA (ej: "extrae tambi칠n el n칰mero de cuenta bancaria") sin tener que tocar el c칩digo y redesplegar el servidor.
Robustez JSON: Las respuestas de los LLM a veces incluyen texto antes del JSON (ej: "Aqu칤 tienes el JSON..."). Aseg칰rate de que el parser limpie la respuesta (buscando el primer { y el 칰ltimo }) antes de hacer JSON.parse(), para evitar errores de sintaxis (SyntaxError).
4. Base de Datos (
shared/schema.ts
)
칈ndices Faltantes: Para mejorar el rendimiento cuando tengas miles de notificaciones:
A침adir 칤ndices a notifications(status), notifications(lexnetId) y notifications(receivedDate).
Esto har치 que el Dashboard cargue instant치neamente incluso con mucho hist칩rico.
5. Frontend (
App.tsx
)
Carga Paralela: En 
server.ts
 (l칤nea 55), el endpoint /api/dashboard hace tres consultas a la base de datos de forma secuencial (await... await... await).
Mejora: Usar Promise.all([db.select... , db.select...]). Esto ejecutar치 las tres consultas a la vez, reduciendo el tiempo de carga del Dashboard a la mitad.